(()=>{"use strict";function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,n(o.key),o)}}function r(e,t,r){return(t=n(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function n(t){var r=function(t,r){if("object"!==e(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,"string");if("object"!==e(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===e(r)?r:String(r)}var o=function(){function e(t,n){var o=this,i=t.item,a=t.cardTemplate,u=t.handleCardClick;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),r(this,"_deleteCard",(function(){o._cardElement.remove()})),r(this,"_toggleLike",(function(e){e.target.classList.toggle(o._buttonLike_active)})),r(this,"_handleImageClick",(function(){o._handleCardClick(o._cardCaption.textContent,o._cardImage.src)})),this._caption=i.name,this._image=i.link,this._handleCardClick=u,this._cardElement=a.querySelector(n.item).cloneNode(!0),this._cardCaption=this._cardElement.querySelector(n.caption),this._cardImage=this._cardElement.querySelector(n.image),this._cardButtonTrash=this._cardElement.querySelector(n.buttonTrash),this._cardButtonLike=this._cardElement.querySelector(n.buttonLike),this._buttonLike_active=n.buttonLike_active}var n,o;return n=e,(o=[{key:"createCard",value:function(){return this._setEventListners(),this._cardCaption.textContent=this._caption,this._cardImage.src=this._image,this._cardImage.alt=this._caption,this._cardElement}},{key:"_setEventListners",value:function(){this._cardButtonTrash.addEventListener("click",this._deleteCard),this._cardButtonLike.addEventListener("click",this._toggleLike),this._cardImage.addEventListener("click",this._handleImageClick)}}])&&t(n.prototype,o),Object.defineProperty(n,"prototype",{writable:!1}),e}();const i=o;function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}function u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==a(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==a(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(n.key),"symbol"===a(o)?o:String(o)),n)}var o}var c=function(){function e(t,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._items=t,this._renderer=r,this._container=document.querySelector(n)}var t,r;return t=e,(r=[{key:"renderItems",value:function(){var e=this;this._items.forEach((function(t){e.addItem(e._renderer(t))}))}},{key:"addItem",value:function(e){this._container.prepend(e)}}])&&u(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==l(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==l(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(n.key),"symbol"===l(o)?o:String(o)),n)}var o}const f=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._form=r,this._formFields=Array.from(r.querySelectorAll(t.fieldSelector)),this._buttonSubmit=r.querySelector(t.submitSelector),this._errorSelectorPrefix=t.errorSelectorPrefix,this._invalidFieldClass=t.invalidFieldClass}var t,r;return t=e,(r=[{key:"_focusHandler",value:function(e){e.select()}},{key:"_toggleFormSubmit",value:function(e){e.disable?this._buttonSubmit.removeAttribute("disabled"):this._buttonSubmit.setAttribute("disabled","disabled")}},{key:"_checkFormValidity",value:function(){this._toggleFormSubmit({disable:!0});var e=this._formFields.every((function(e){return e.validity.valid}));return e||this._toggleFormSubmit({disable:!1}),e}},{key:"_setFieldError",value:function(e,t,r){var n=r.validationMessage,o=r.valid,i=r.invalidFieldClass;t.textContent=n,o?e.classList.remove(i):e.classList.add(i)}},{key:"_checkFieldValidity",value:function(e,t,r){var n=e.validationMessage,o=e.validity.valid,i={validationMessage:n,valid:o,invalidFieldClass:r};return this._setFieldError(e,t,i),o}},{key:"_setEventListners",value:function(){var e=this;this._formFields.forEach((function(t){var r=".".concat(e._errorSelectorPrefix+t.name),n=e._form.querySelector(r);t.addEventListener("input",(function(t){var r=t.target;e._checkFormValidity(),e._checkFieldValidity(r,n,e._invalidFieldClass)})),t.addEventListener("focus",e._focusHandler(t))})),this._form.addEventListener("click",(function(e){return e.stopPropagation()}))}},{key:"enableValidation",value:function(){this._setEventListners()}},{key:"resetFormErrors",value:function(e){var t=this,r=e.disable;this._toggleFormSubmit({disable:r}),this._formFields.forEach((function(e){var r=".".concat(t._errorSelectorPrefix+e.name);t._form.querySelector(r).textContent="",e.classList.remove(t._invalidFieldClass)}))}}])&&s(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function p(e){return p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},p(e)}function y(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==p(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==p(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(n.key),"symbol"===p(o)?o:String(o)),n)}var o}var d=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._popup=document.querySelector(t),this._closeButton=this._popup.querySelector(".popup__btn-close"),this._handleEscape=this._handleEscape.bind(this)}var t,r;return t=e,(r=[{key:"_handleEscape",value:function(e){"Escape"===e.key&&this.close()}},{key:"open",value:function(){this._popup.classList.add("popup_opened"),document.addEventListener("keydown",this._handleEscape)}},{key:"close",value:function(){this._popup.classList.remove("popup_opened"),document.removeEventListener("keydown",this._handleEscape)}},{key:"setEventListeners",value:function(){var e=this;this._closeButton.addEventListener("click",this.close.bind(this)),this._popup.addEventListener("mousedown",(function(t){t.target===t.currentTarget&&e.close()}))}}])&&y(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),m={template:"#element_template",list:".elements__list",item:".elements__item",caption:".elements__caption",image:".elements__image",buttonTrash:".elements__trash-button",buttonLike:".elements__like-button",buttonLike_active:"elements__like-button_active"},b={formSelector:".popup__form",fieldSelector:".popup__input",submitSelector:".popup__btn-save",invalidFieldClass:"popup__input_invalid",errorSelectorPrefix:"popup__input-error_field_"},v=document.forms.profile,h=document.forms.place,_=document.querySelector(".profile__btn-edit"),g=document.querySelector(".profile__btn-add"),S=document.querySelector(m.template).content;function k(e){return k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},k(e)}function w(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==k(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==k(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(n.key),"symbol"===k(o)?o:String(o)),n)}var o}function E(){return E="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=P(e)););return e}(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},E.apply(this,arguments)}function j(e,t){return j=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},j(e,t)}function P(e){return P=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},P(e)}var O=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&j(e,t)}(a,e);var t,r,n,o,i=(n=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=P(n);if(o){var r=P(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===k(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=i.call(this,e))._popupImage=t._popup.querySelector(".popup__image"),t._popupCaption=t._popup.querySelector(".popup__caption"),t}return t=a,(r=[{key:"open",value:function(e,t){E(P(a.prototype),"open",this).call(this),this._popupImage.setAttribute("src",t),this._popupImage.setAttribute("alt",e),this._popupCaption.textContent=e}}])&&w(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),a}(d);function C(e){return C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},C(e)}function L(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==C(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==C(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(n.key),"symbol"===C(o)?o:String(o)),n)}var o}function F(){return F="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=x(e)););return e}(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},F.apply(this,arguments)}function T(e,t){return T=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},T(e,t)}function x(e){return x=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},x(e)}var I=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&T(e,t)}(a,e);var t,r,n,o,i=(n=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=x(n);if(o){var r=x(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===C(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function a(e,t){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(r=i.call(this,e))._handleFormSubmit=t,r._form=r._popup.querySelector(b.formSelector),r._inputs=Array.from(r._form.querySelectorAll(b.fieldSelector)),r}return t=a,(r=[{key:"_getInputValues",value:function(){var e={};return this._inputs.forEach((function(t){e[t.id]=t.value})),e}},{key:"setEventListeners",value:function(){var e=this;F(x(a.prototype),"setEventListeners",this).call(this),this._form.addEventListener("submit",(function(t){e._handleFormSubmit(t,e._getInputValues())}))}},{key:"setInputValues",value:function(e){this._inputs.forEach((function(t){t.value=e[t.name]}))}},{key:"close",value:function(){F(x(a.prototype),"close",this).call(this),this._form.reset()}}])&&L(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),a}(d);function q(e){return q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},q(e)}function R(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==q(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==q(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(n.key),"symbol"===q(o)?o:String(o)),n)}var o}var A=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._userName=document.querySelector(t),this._userAbout=document.querySelector(r)}var t,r;return t=e,(r=[{key:"getUserInfo",value:function(){var e={};return e.name=this._userName.textContent,e.about=this._userAbout.textContent,e}},{key:"setUserInfo",value:function(e){var t=e.userName,r=e.userAbout;this._userName.textContent=t,this._userAbout.textContent=r}}])&&R(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),B={};!function(e){Array.from(document.querySelectorAll(e.formSelector)).forEach((function(t){var r=new f(e,t),n=t.getAttribute("name");B[n]=r,r.enableValidation()}))}(b);var V=new A(".profile__name",".profile__about"),D=new I(".popup_type_edit-profile",(function(e,t){e.preventDefault(),V.setUserInfo({userName:t.name,userAbout:t.about}),D.close()}));D.setEventListeners();var N=new I(".popup_type_add-card",(function(e,t){e.preventDefault();var r={name:t.caption,link:t.image};H.addItem(M(r)),N.close()}));N.setEventListeners();var U=new O(".popup_type_show-image");function M(e){return new i({item:e,cardTemplate:S,handleCardClick:z},m).createCard()}U.setEventListeners();var H=new c([{name:"Архыз",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/arkhyz.jpg"},{name:"Челябинская область",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/chelyabinsk-oblast.jpg"},{name:"Иваново",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/ivanovo.jpg"},{name:"Камчатка",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kamchatka.jpg"},{name:"Холмогорский район",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kholmogorsky-rayon.jpg"},{name:"Байкал",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/baikal.jpg"}],M,m.list);function z(e,t){U.open(e,t)}H.renderItems(),_.addEventListener("click",(function(e){e.preventDefault(),B.profile.resetFormErrors({disable:!0}),D.setInputValues(V.getUserInfo()),v.name.focus(),D.open()})),g.addEventListener("click",(function(e){e.preventDefault(),B.place.resetFormErrors({disable:!1}),h.caption.focus(),N.open()}))})();